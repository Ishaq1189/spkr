<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>spkr</title>
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/styles.css">

	<script src="js/jquery-2.1.4.min.js"></script>
	<script src="js/js.cookie-2.0.4.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container">
		<a class="navbar-brand" href="/">spkr</a>
		<button class="btn-link btn-sm" id="logoutBtn" tabindex="-1">logout</button>
	</div>
</nav>

<div class="container-fluid">
	<div class="row">
		<div class="col-xs-3">

			<div class="container-fluid">
				<div class="row">
					<form class="form-horizontal vertical-block" id="searchForm">
						<div class="input-group">
							<input type="text" placeholder="user search" class="form-control input-sm" name="q">
				      <span class="input-group-btn">
				        <button type="submit" class="btn btn-default btn-sm">search</button>
				      </span>
						</div>
					</form>
				</div>
			</div>

			<ul class="list-group">
				<li class="list-group-item">1</li>
			</ul>
		</div>
		<div class="col-xs-9">
			<div id="chat"></div>
		</div>
	</div>
</div>

<div class="modal fade" id="searchModal" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				add to contacts
			</div>
			<div class="modal-body">
			</div>
		</div>
	</div>
</div>

<script>
	$("#logoutBtn").click(function() {
		Cookies.remove("sid");
		window.location = "login.html";
	});

	$("#searchForm").submit(function(event) {
		event.preventDefault();
		$.get("/api/user/search", $("#searchForm").serialize(), function(data) {
			var modal = $("#searchModal");
			var modalBody = $(".modal-body");
			modal.on("hidden.bs.modal", function() {
				modalBody.empty();
			});
			data.forEach(function(user) {
				$('<p><button type="submit" class="btn btn-default btn-sm" data-dismiss="modal">' + user + '</button></p>').
				appendTo(modalBody).click(function() {
					modal.modal("hide");
				});
			});
			modal.modal("show");
		}).fail(function(response) {
			alert(response.responseText);
		});
	});

	if (! Cookies.get("sid"))
		window.location = "login.html";
</script>
</body>
</html>